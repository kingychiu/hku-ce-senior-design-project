import matplotlib.pyplot as plt

acc = [0.55378729118, 0.653369530215, 0.67428479414, 0.686815355106, 0.69465120816, 0.701423381009,
       0.706158912466, 0.709594894344, 0.713629621576, 0.715840897038, 0.718811944066,
       0.720569624563, 0.72403962606, 0.724760842075, 0.726432339511, 0.729020098803,
       0.730659844614, 0.731281269713, 0.732206603446, 0.734261388652, 0.734175205601,
       0.736397820939, 0.736939866925, 0.737345834413, 0.73809653409, 0.739343920256,
       0.740473371712, 0.741491692417, 0.741929411549, 0.741487156474, 0.742959072147,
       0.743750595339, 0.743739255484, 0.744421915904, 0.745245190769, 0.745698785741,
       0.74621815198, 0.747066374561, 0.747535845345, 0.748195826035, 0.748211701852,
       0.747805734356, 0.748935185824, 0.748433963387, 0.748270669198, 0.749998866021,
       0.74981969601, 0.750103192863, 0.750007937921, 0.751035330508, 0.751257592048,
       0.751368722822, 0.751484389544, 0.75134150713, 0.752033239449, 0.752777135194,
       0.752203337554, 0.752895069892, 0.751960664254, 0.753210318382]
val_acc = [0.658395381209, 0.687040594395, 0.70123354872, 0.70834590167, 0.715124863075,
           0.717432144242, 0.722512396349, 0.724512745616, 0.724867304877, 0.72917493531,
           0.73056142078, 0.729079680584, 0.733207385421, 0.733990590954, 0.731535135769,
           0.733440230309, 0.736117946524, 0.737848407397, 0.736324331766, 0.737382717622,
           0.739409526535, 0.738441103477, 0.739758793868, 0.738753327304, 0.74091243445,
           0.742224832911, 0.737811363892, 0.741907317154, 0.739689998787, 0.741076484258,
           0.741081776186, 0.741145279338, 0.741192906702, 0.74083834744, 0.742849280566,
           0.742679938829, 0.741965528376, 0.744119343593, 0.744415691632, 0.744606201087,
           0.742404758507, 0.743748908542, 0.74355310716, 0.743965877643, 0.741515714387,
           0.744865505621, 0.741050024611, 0.745892139901, 0.745553456427, 0.745347071186,
           0.740377949593, 0.734297522851, 0.746797059807, 0.745765133599, 0.745886847972,
           0.745183021377, 0.744791418611, 0.745669878871, 0.745722798164, 0.745738673952]
plt.ylabel('Acc.')
plt.xlabel('Epochs')

acc_line, = plt.plot(acc, label="Training Acc.", linewidth=2)
val_acc_line, = plt.plot(val_acc, label="Test Acc.", linewidth=2)
first_legend = plt.legend(handles=[acc_line, val_acc_line], loc=4)

# closest point between 2 line
min_diff_idx = 0
max_acc_idx = 0
for i in range(0, len(acc)):
    diff = abs(acc[i] - val_acc[i])
    if abs(acc[i] - val_acc[i]) < abs(acc[min_diff_idx] - val_acc[min_diff_idx]):
        min_diff_idx = i
    if val_acc[i] > val_acc[max_acc_idx]:
        max_acc_idx = i

plt.annotate(str(val_acc[min_diff_idx]), xy=(min_diff_idx, val_acc[min_diff_idx]),
             xytext=(min_diff_idx + 2, val_acc[min_diff_idx] - 0.1),
             arrowprops=dict(facecolor='black', shrink=0.05),
             )
plt.annotate(str(val_acc[max_acc_idx]), xy=(max_acc_idx, val_acc[max_acc_idx]),
             xytext=(max_acc_idx - 3, val_acc[max_acc_idx] - 0.1),
             arrowprops=dict(facecolor='black', shrink=0.05),
             )

plt.show()
